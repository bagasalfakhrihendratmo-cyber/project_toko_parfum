<!DOCTYPE html>
<html lang="en" data-theme="elegant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Buy <%= perfume.name %></title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600&family=Playfair+Display:wght@400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/css/output.css">
</head>
<body class="min-h-screen bg-base-200 flex items-center justify-center">
    <main class="w-full max-w-3xl px-4">
        <div class="bg-base-100 p-8 rounded-xl shadow-2xl grid grid-cols-1 md:grid-cols-2 gap-6">
            <div class="flex flex-col gap-4">
                <img src="<%= (perfume.image && perfume.image.trim() !== '' ) ? perfume.image : '/assets/no-image.svg' %>" alt="<%= perfume.name %>" class="w-full h-48 object-cover rounded-md" />
                <h2 class="text-2xl font-serif"><%= perfume.name %></h2>
                <p class="text-sm text-muted"><%= perfume.description %></p>
                <p class="text-xl font-bold">Rp <%= perfume.price %></p>
                <p class="text-sm">Stok tersedia: <strong><%= (typeof perfume.stock !== 'undefined' ? perfume.stock : 0) %></strong></p>
            </div>

            <div>
                <h3 class="text-xl mb-4">Form Pembelian</h3>
                <% const available = typeof perfume.stock !== 'undefined' ? perfume.stock : 0; %>
                <% if (available <= 0) { %>
                    <div class="alert alert-error">Maaf, produk sedang kosong (out of stock).</div>
                <% } %>
                <form action="/buy/<%= perfume.id %>" method="POST" class="space-y-4">
                    <div>
                        <label class="label">Nama Penerima</label>
                        <input type="text" name="recipient" class="input input-bordered w-full" required />
                    </div>
                    <div>
                        <label class="label">Alamat Pengiriman</label>
                        <textarea name="address" class="textarea textarea-bordered w-full" rows="3" required></textarea>
                    </div>
                    <div>
                        <label class="label">Jumlah</label>
                        <input type="number" name="quantity" min="1" max="<%= available %>" value="1" class="input input-bordered w-32" required />
                    </div>
                    <div>
                        <label class="label">Metode Pembayaran</label>
                        <select name="payment" class="select select-bordered w-full">
                            <option value="cod">Cash on Delivery</option>
                            <option value="bank">Transfer Bank</option>
                        </select>
                    </div>
                    <div>
                        <button type="submit" class="btn btn-primary w-full">Konfirmasi Pembelian</button>
                    </div>
                </form>
            </div>
        </div>
    </main>
</body>
</html>
